<!DOCTYPE html>
<html>
<head>
    <title>iSales | Home</title>
    <link rel="stylesheet" type="text/css" href="./style/styles.css">
    <script src="./script/script.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="./script//sessionHandling.js"></script>
    <script src="./script//shopAndBasket.js"></script>
    <script src="./script//urlParameter.js"></script>

</head>
<body>
    <!-- Header-Bereich -->
    <header class="header">
        <div class="header-left">
            <div class="logo">
                <a href="index.html">
                    <img src="./img/iapplesales-logo-white-transparent.png" alt="iAppleSales - Logo">
                </a>
            </div>
        </div>

        <div class="header-center">
            <h1> Willkommen bei IAppleSales! </h1>
            <nav>
                <ul class="navigation">
                    <li><a href="kategorieseite_IPhones.html">iPhones</a></li>
                    <li><a href="kategorieseite_IPads.html">iPads</a></li>
                    <li><a href="kategorieseite_IMacs.html">iMacs</a></li>
                    <li><a href="kategorieseite_Zubehoer.html">Zubehör</a></li>
                </ul>
            </nav>
        </div>
        <div class="header-right">
            <div class="cart">
                <span class="cart-icon">&#128722;</span>
                <span class="cart-count">0</span>
            </div>
        </div>
    </header>

    <!-- Suchfeld -->
    <div class="search">
        <input type="text" placeholder="Suche..." id="Suchbegriff">
        <button class="search-button">Suchen</button>
    </div>

    <!-- Inhalt der Webseite  -->
    <div class="content">
        <!-- Produkt-Schaufenster -->
        <div class="product-container" id="productList">
            <!-- 1. Produkt -->
            <div class="product">
                <div class="product-picture">
                    <img src="./img/iMac_mini.png" alt="Produkt 1" class="product-image">
                </div>
                <div class="product-title">
                    <h2> iMac mini</h2>
                </div>
                <div class="product-text">
                    <h2> Preis: 899,99 € inkl. MwSt. <br> versandkostenfrei</h2>
                    <p>APPLE iMac, All-in-One PC mit 15 Zoll Display, 25 GB Arbeitsspeicher, bis zu 2 TD Speicherplat5, Silber</p>
                    <a href="default_produktdetail.html?id=9">
                    <button class="add-to-cart-button">zum Produkt</button>
                    </a>
                </div>
            </div>
            <!-- 2. Produkt-->
            <div class="product">
                <div class="product-picture">
                    <img src="./img/iMac_small.png" alt="Produkt 2" class="product-image">
                </div>
                <div class="product-title">
                    <h2>iMac 21.5" </h2>
                </div>
                <div class="product-text">
                    <h2> Preis: 999,99 € inkl. MwSt. <br> versandkostenfrei</h2>
                    <p>APPLE iMac (2020), All-in-One PC mit 21,5 Zoll Display, Intel® Core™ i5 Prozessor, 8 GB RAM, 256 GB SSD, Silber</p>
                    <a href="default_produktdetail.html?id=10">
                    <button class="add-to-cart-button" >zum Produkt</button>
                    </a>
                </div>
            </div>

            <!-- 3. Produkt-->
            <div class="product">
                <div class="product-picture">
                    <img src="./img/iMac_mid.png" alt="Produkt 3" class="product-image">
                </div>
                <div class="product-title">
                    <h2>iMac 23.5"</h2>
                </div>
                <div class="product-text">
                    <h2> Preis: 1499,99 € inkl. MwSt. <br> versandkostenfrei</h2>
                    <p>APPLE iMac (2023), All-in-One PC mit 23.5 Zoll Display, Apple M3 Chip, 8 GB RAM, 10-Core GPU, 512 GB SSD, Silber</p>
                    <a href="default_produktdetail.html?id=11">
                    <button class="add-to-cart-button">zum Produkt</button>
                    </a>
                </div>
            </div>

            <!-- 4. Produkt-->
            <div class="product">
                <div class="product-picture">
                    <img src="./img/iMac_big.png" alt="Produkt 4" class="product-image">
                </div>
                <div class="product-title">
                    <h2> iMac 27"</h2>
                </div>
                <div class="product-text">
                    <h2> Preis: 1699,99 € inkl. MwSt. <br> versandkostenfrei</h2>
                    <p>APPLE iMac (2020), All-in-One PC mit 27 Zoll Display, 32 GB RAM, 1 TB SSD, Radeon Pro Vega 56, Silber</p>
                    <a href="default_produktdetail.html?id=12">
                    <button class="add-to-cart-button">zum Produkt</button>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer-Bereich -->
    <footer class="footer">
        &copy; 2023 iAppleSales - Alle Rechte vorbehalten | 
        <a href="about_Us.html">Über Uns</a> | 
        <a href="agb.html">AGB</a> | 
        <a href="datenschutz.html">Datenschutz</a> | 
        <a href="impressum.html">Impressum</a>
    </footer>
    <script>
        $(document).ready(function() {
			
            // get id from url parameter
            var id = -1;

            if (existsUrlParameter('id')) 
                id = getUrlParameterValue('id');

            console.log('target category id=' + id);

            if (id == -1) {
                alert('keine id erhalten');
                return;
            }  

			$.ajax({
                url: 'http://localhost:8000/api/produkt/gib/kategorieId/' + id,
                method: 'get',
                contentType: 'application/json; charset=utf-8',
                cache: false,
				dataType: 'json'
            }).done(function (response) {
                console.log(response);
                renderProducts(response);

                function renderProducts(produkte) {
                    var produktListeElement = $('#productList');

                    // Itteration durch die Produkte
                    for (var i = 0; i < produkte.length; i++) {
                        var produkt = response[i];
                        var produktHTML = '<div class="product">';
                        produktHTML += '<div class="product-picture">';
                        var pic = produkt.bilder[0];
                        var bildpfad = 'http://localhost:8000/' + pic.bildpfad; 
                        produktHTML += '<a href="default_produktdetail.html?id=' + produkt.id +'">';
                        produktHTML += '<img src="' + bildpfad + '" class="product-image">';
                        produktHTML += '</a>';
                        produktHTML += '</div>';
                        produktHTML += '<div class="product-title">';
                        produktHTML += '<h2>' + produkt.bezeichnung + '</h2>';
                        produktHTML += '</div>';
                        produktHTML += '<div class="product-text">';
                        produktHTML += '<h2>Preis: ' + produkt.bruttopreis + '€ inkl. MwSt <br> versandkostenfrei</h2>'; 
                        produktHTML += produkt.kurzbeschreibung;
                        produktHTML += '<br>';
                        produktHTML += '<a href="default_produktdetail.html?id=' + produkt.id +'">';
                        produktHTML += '<button class="add-to-cart-button">zum Produkt</button> </a>';
                        // Abschluss des Renderns
                        produktHTML += '</div>';
                        produktListeElement.append(produktHTML);
                    };
                }

            }).fail(function (jqXHR, statusText, error) {
                console.log('Response Code: ' + jqXHR.status + ' - Fehlermeldung: ' + jqXHR.responseText);
                alert('Ein Fehler ist aufgetreten');
            });
        });
    </script>
</body>
</html>
